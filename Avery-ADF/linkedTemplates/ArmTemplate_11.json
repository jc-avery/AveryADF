{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "Avery-ADF"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/PL_SoftWorks_API_Employee')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Download Employee data",
						"description": "Start date in the body looks to be irrelevant, it uses the end date to return emp with a start date less than that. ",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Employee File Name",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:00",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "POST",
								"requestBody": {
									"value": "@concat('{\n    \"DataExtractType\": 4000,\n    \"StartDate\": \"',variables('TodaysDate'),'\",\n    \"EndDate\": \"',variables('ThreeMonthsAhead'),'\",\n    \"Customer\": \"internal\"\n}')",
									"type": "Expression"
								},
								"additionalHeaders": {
									"Content-Type": "application/json"
								},
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_Softworks_API_Employees",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_PolestarStorageAcc_Softworks",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@variables('EmpFileName')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set Todays Date",
						"description": "Used in sink to Store the files in folder with todays date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "TodaysDate",
							"value": {
								"value": "@formatDateTime(utcNow(), 'dd-MM-yyyy')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set One Months Ahead",
						"description": "Set to the end of the month, 1 month ahead. Used in the API call so details of future starters is returned.",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Todays Date",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ThreeMonthsAhead",
							"value": {
								"value": "@formatDateTime(addToTime(utcNow(), 1, 'Month'), 'dd-MM-yyyy')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set WeekEndingDate",
						"description": "Set the previous week ending date in the dd-MM-yyyy format for the API",
						"type": "SetVariable",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "WeekEndingDate",
							"value": {
								"value": "@formatDateTime(subtractFromTime(utcNow(), dayOfWeek(utcNow()), 'Day'), 'dd-MM-yyyy')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set WeekBegining Date",
						"description": "Set the previous week Start date in the dd-MM-yyyy format for the API",
						"type": "SetVariable",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Set WeekEndingDate",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "WeekBeginingDate",
							"value": {
								"value": "@formatDateTime(subtractFromTime(subtractFromTime(utcNow(), dayOfWeek(utcNow()), 'Day'), 6, 'Day'), 'dd-MM-yyyy')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Download Clockings data",
						"description": "Start date in the body looks to be irrelevant, it uses the end date to return emp with a start date less than that. ",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Set Clockings File Name",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:00",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "POST",
								"requestBody": {
									"value": "@concat('{\n    \"DataExtractType\": 2000,\n    \"StartDate\": \"',variables('WeekBeginingDate'),'\",\n    \"EndDate\": \"',variables('WeekEndingDate'),'\",\n    \"Customer\": \"internal\"\n}')",
									"type": "Expression"
								},
								"additionalHeaders": {
									"Content-Type": "application/json"
								},
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_Softworks_API_Employees",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_PolestarStorageAcc_Softworks",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@variables('ClockingsFileName')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set Clockings File Name",
						"type": "SetVariable",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Set WeekBegining Date",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ClockingsFileName",
							"value": {
								"value": "@concat('Clockings', '$', variables('WeekBeginingDate'), '$', variables('WeekEndingDate') )",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Employee File Name",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set One Months Ahead",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EmpFileName",
							"value": {
								"value": "@concat('EmployeeList', '$', variables('TodaysDate'))",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"TodaysDate": {
						"type": "String"
					},
					"ThreeMonthsAhead": {
						"type": "String"
					},
					"EmpFileName": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Softworks/Children Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2024-04-10T11:21:25Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Softworks_EmployeeHoliday')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each File",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get File List",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get File List').output.childItems",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy from file to SQL",
									"description": "the @item().Name variable is key on the source. the .Name provides the childItem Name from the output of the Metadata task",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true,
												"wildcardFolderPath": "EmployeeHoliday",
												"wildcardFileName": {
													"value": "@item().Name",
													"type": "Expression"
												},
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "Employee",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Employee",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "EmployeeNumber",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "EmployeeNumber",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Start Date",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "StartDate",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "End Date",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "EndDate",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Hours Duration",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "HoursDuration",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Absence Type",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "AbsenceType",
														"type": "String",
														"physicalType": "varchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_PolestarStorageAcc_Softworks_RateSheets",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_AH2_TRANSFORM_DB",
											"type": "DatasetReference",
											"parameters": {
												"Schema": "Softworks",
												"Table": "EmployeeHoliday"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Get File List",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_softworks_EmployeeHoliday",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Softworks"
				},
				"annotations": [],
				"lastPublishTime": "2024-08-20T15:53:45Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Softworks_RateSheets')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each File",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get File List",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get File List').output.childItems",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy from file to SQL",
									"description": "the @item().Name variable is key on the source. the .Name provides the childItem Name from the output of the Metadata task",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true,
												"wildcardFolderPath": "RateSheets",
												"wildcardFileName": {
													"value": "@item().Name",
													"type": "Expression"
												},
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "Employee Number",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "EmployeeID",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Employee Name",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "EmployeeName",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Contract Type",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "ContractType",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Contract Start Date",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "ContractStartDate",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Contract End Date",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "ContractEndDate",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "External Reference",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "ExternalReference",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Is Default",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "IsDefault",
														"type": "String",
														"physicalType": "varchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_PolestarStorageAcc_Softworks_RateSheets",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_AH2_TRANSFORM_DB",
											"type": "DatasetReference",
											"parameters": {
												"Schema": "Softworks",
												"Table": "EmployeeRates"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Get File List",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_PolestarStorageAcc_Softworks_RateSheets",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Softworks"
				},
				"annotations": [],
				"lastPublishTime": "2024-07-23T14:21:03Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_GetData')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Extract Data Func",
						"description": "Call the azure function to make the api call",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set variable2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Data_Extract",
								"type": "DatasetReference",
								"parameters": {
									"FunctionCode": {
										"value": "@variables('AzFuncCode')",
										"type": "Expression"
									},
									"API_TOKEN": {
										"value": "@variables('APIToken')",
										"type": "Expression"
									},
									"end_point": "@pipeline().parameters.EndPoint",
									"min_start_date": {
										"value": "@pipeline().parameters.MinStartDate",
										"type": "Expression"
									},
									"max_start_date": {
										"value": "@pipeline().parameters.MaxStartDate",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Sona_API_Response",
								"type": "DatasetReference",
								"parameters": {
									"FileName": "@pipeline().parameters.EndPoint"
								}
							}
						]
					},
					{
						"name": "Get AZ Func Code",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"url": "https://avery-adf-keyvault.vault.azure.net/secrets/SonaAPICallAzFunc/af4b3d6f9dad4efa936e00727c70829c?api-version=7.3",
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "Get Sona API Token",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"url": "https://avery-adf-keyvault.vault.azure.net/secrets/SonaAPIToken/559963575ce3414abe3d756da8dd179f?api-version=7.3",
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get AZ Func Code",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "AzFuncCode",
							"value": {
								"value": "@activity('Get AZ Func Code').output.value",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set variable2",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get Sona API Token",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "APIToken",
							"value": {
								"value": "@activity('Get Sona API Token').output.value",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"EndPoint": {
						"type": "string"
					},
					"MinStartDate": {
						"type": "string"
					},
					"MaxStartDate": {
						"type": "string"
					}
				},
				"variables": {
					"APIToken": {
						"type": "String"
					},
					"AzFuncCode": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Sona/Child Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_ContractTypes')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ContractTypes",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "ContractTypes_id"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['denomination']"
										},
										"sink": {
											"name": "denomination",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_type']"
										},
										"sink": {
											"name": "employment_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['booking_granularity']"
										},
										"sink": {
											"name": "booking_granularity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['holiday_allowance_rounding']"
										},
										"sink": {
											"name": "holiday_allowance_rounding",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['include_absence_cost']"
										},
										"sink": {
											"name": "include_absence_cost",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['only_worked_days']"
										},
										"sink": {
											"name": "only_worked_days",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['pay_period_start']"
										},
										"sink": {
											"name": "pay_period_start",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['pay_period_type']"
										},
										"sink": {
											"name": "pay_period_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['payroll_rule']"
										},
										"sink": {
											"name": "payroll_rule",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['worked_days_in_year']"
										},
										"sink": {
											"name": "worked_days_in_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['worked_weeks_in_year']"
										},
										"sink": {
											"name": "worked_weeks_in_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_basis']"
										},
										"sink": {
											"name": "employment_basis",
											"type": "String"
										}
									}
								],
								"collectionReference": ""
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "contract_types - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_ContractTypes"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_ContractedHours')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ContractedHours",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "ContractedHours_id"
										}
									},
									{
										"source": {
											"path": "$['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['hours']"
										},
										"sink": {
											"name": "hours",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['days']"
										},
										"sink": {
											"name": "days",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['start_date']"
										},
										"sink": {
											"name": "start_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['idx']"
										},
										"sink": {
											"name": "idx",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['finish_date']"
										},
										"sink": {
											"name": "finish_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['org_unit_id']"
										},
										"sink": {
											"name": "org_unit_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_period_id']"
										},
										"sink": {
											"name": "employment_period_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['colour_coding']"
										},
										"sink": {
											"name": "colour_coding",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['type_of_work_id']"
										},
										"sink": {
											"name": "type_of_work_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['monthly_period_starts_at']"
										},
										"sink": {
											"name": "monthly_period_starts_at",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['weekly_period_starts_at']"
										},
										"sink": {
											"name": "weekly_period_starts_at",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['rolling_period_sequence_length_days']"
										},
										"sink": {
											"name": "rolling_period_sequence_length_days",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['rolling_period_sequence_start']"
										},
										"sink": {
											"name": "rolling_period_sequence_start",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_period_idx']"
										},
										"sink": {
											"name": "employment_period_idx",
											"type": "String"
										}
									}
								],
								"collectionReference": ""
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "contracted_hours - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_ContractedHours"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_EmploymentPeriods')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "EmploymentPeriods",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['active']"
										},
										"sink": {
											"name": "active",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "EmploymentPeriods_id"
										}
									},
									{
										"source": {
											"path": "$['start_date']"
										},
										"sink": {
											"name": "start_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['idx']"
										},
										"sink": {
											"name": "idx",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['job_id']"
										},
										"sink": {
											"name": "job_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['organisation_id']"
										},
										"sink": {
											"name": "organisation_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['user_id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['finish_date']"
										},
										"sink": {
											"name": "finish_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['organisation_user_id']"
										},
										"sink": {
											"name": "organisation_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['id']"
										},
										"sink": {
											"name": "employment_specs_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['id']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['period']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['hours']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_hours",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['days']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_days",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['start_date']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_start_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['idx']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_idx",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['org_unit_id']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_org_unit_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['finish_date']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_finish_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['colour_coding']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_colour_coding",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['type_of_work_id']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_type_of_work_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['monthly_period_starts_at']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_monthly_period_starts_at",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['weekly_period_starts_at']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_weekly_period_starts_at",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['rolling_period_sequence_length_days']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_rolling_period_sequence_length_days",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contracted_hours'][0]['rolling_period_sequence_start']"
										},
										"sink": {
											"name": "employment_specs_contracted_hours_rolling_period_sequence_start",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contract_types'][0]['id']"
										},
										"sink": {
											"name": "employment_specs_contract_types_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contract_types'][0]['name']"
										},
										"sink": {
											"name": "employment_specs_contract_types_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contract_types'][0]['employment_type']"
										},
										"sink": {
											"name": "employment_specs_contract_types_employment_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contract_types'][0]['pay_period_start']"
										},
										"sink": {
											"name": "employment_specs_contract_types_pay_period_start",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contract_types'][0]['pay_period_type']"
										},
										"sink": {
											"name": "employment_specs_contract_types_pay_period_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contract_types'][0]['payroll_rule']"
										},
										"sink": {
											"name": "employment_specs_contract_types_payroll_rule",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['contract_types'][0]['employment_basis']"
										},
										"sink": {
											"name": "employment_specs_contract_types_employment_basis",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['rates_of_pay'][0]['id']"
										},
										"sink": {
											"name": "employment_specs_rates_of_pay_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['rates_of_pay'][0]['start_date']"
										},
										"sink": {
											"name": "employment_specs_rates_of_pay_start_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['rates_of_pay'][0]['idx']"
										},
										"sink": {
											"name": "employment_specs_rates_of_pay_idx",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['rates_of_pay'][0]['finish_date']"
										},
										"sink": {
											"name": "employment_specs_rates_of_pay_finish_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['rates_of_pay'][0]['rate']"
										},
										"sink": {
											"name": "employment_specs_rates_of_pay_rate",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_specs'][0]['rates_of_pay'][0]['pay_type']"
										},
										"sink": {
											"name": "employment_specs_rates_of_pay_pay_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['primary_org_unit_id']"
										},
										"sink": {
											"name": "primary_org_unit_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employee_number']"
										},
										"sink": {
											"name": "employee_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['continuous_employment_start_date']"
										},
										"sink": {
											"name": "continuous_employment_start_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['level_id']"
										},
										"sink": {
											"name": "level_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['job_grade_id']"
										},
										"sink": {
											"name": "job_grade_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['reports_to_user_id']"
										},
										"sink": {
											"name": "reports_to_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['reports_to_org_user_id']"
										},
										"sink": {
											"name": "reports_to_org_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['starter_declaration']"
										},
										"sink": {
											"name": "starter_declaration",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['student_loan_plan_four']"
										},
										"sink": {
											"name": "student_loan_plan_four",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['student_loan_plan_one']"
										},
										"sink": {
											"name": "student_loan_plan_one",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['student_loan_plan_two']"
										},
										"sink": {
											"name": "student_loan_plan_two",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['student_loan_post_graduate']"
										},
										"sink": {
											"name": "student_loan_post_graduate",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['tupe']"
										},
										"sink": {
											"name": "tupe",
											"type": "String"
										}
									}
								],
								"collectionReference": "",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "employment_periods - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_EmploymentPeriods"
								}
							}
						]
					},
					{
						"name": "EmploymentPeriods_TypesOfWork",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "EmploymentPeriods",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "employment_period_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "type_of_work_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['name']"
										},
										"sink": {
											"name": "type_of_work_name",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['types_of_work']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "employment_periods - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_EmploymentPeriods_TypesOfWork"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_Jobs')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Jobs",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "Jobs_id"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['upload_id']"
										},
										"sink": {
											"name": "upload_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['archived_at']"
										},
										"sink": {
											"name": "archived_at",
											"type": "String"
										}
									}
								],
								"collectionReference": "",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "jobs - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_Jobs"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_OrgUnits')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "OrgUnits",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "OrgUnits_id"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['timezone']"
										},
										"sink": {
											"name": "timezone",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['is_base_entity']"
										},
										"sink": {
											"name": "is_base_entity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['org_unit_type']['id']"
										},
										"sink": {
											"name": "org_unit_type_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['org_unit_type']['name']"
										},
										"sink": {
											"name": "org_unit_type_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['accounting_cost_code']"
										},
										"sink": {
											"name": "accounting_cost_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['average_hourly_rate']"
										},
										"sink": {
											"name": "average_hourly_rate",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['paycaptain_company_id']"
										},
										"sink": {
											"name": "paycaptain_company_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['parent_org_unit']['id']"
										},
										"sink": {
											"name": "parent_org_unit_id",
											"type": "String"
										}
									}
								],
								"collectionReference": ""
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "org_units - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_OrgUnits"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_OrgUnitsTypes')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "OrgUnitsTypes",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "OrgUnitsTypes_id"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['parent_org_unit_type']['id']"
										},
										"sink": {
											"name": "parent_org_unit_type_id",
											"type": "String"
										}
									}
								],
								"collectionReference": ""
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "org_unit_types - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_OrgUnitsTypes"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_RatesOfPay')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "RatesOfPay",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "RatesOfPay_id"
										}
									},
									{
										"source": {
											"path": "$['label']"
										},
										"sink": {
											"name": "label",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['start_date']"
										},
										"sink": {
											"name": "start_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['idx']"
										},
										"sink": {
											"name": "idx",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['user_id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['finish_date']"
										},
										"sink": {
											"name": "finish_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['org_unit_id']"
										},
										"sink": {
											"name": "org_unit_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['organisation_user_id']"
										},
										"sink": {
											"name": "organisation_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_period_id']"
										},
										"sink": {
											"name": "employment_period_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['type_of_work_id']"
										},
										"sink": {
											"name": "type_of_work_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['rate']"
										},
										"sink": {
											"name": "rate",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['pay_type']"
										},
										"sink": {
											"name": "pay_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['employment_period_idx']"
										},
										"sink": {
											"name": "employment_period_idx",
											"type": "String"
										}
									}
								],
								"collectionReference": "",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "rates_of_pay - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_RatesOfPay"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_ShiftTypes')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ShiftTypes",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "ShiftTypes_id"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['description']"
										},
										"sink": {
											"name": "description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['color']"
										},
										"sink": {
											"name": "color",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['org_unit']['id']"
										},
										"sink": {
											"name": "org_unit_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['type_of_work']['id']"
										},
										"sink": {
											"name": "type_of_work_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['is_sleep']"
										},
										"sink": {
											"name": "is_sleep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['is_absence']"
										},
										"sink": {
											"name": "is_absence",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['default_end_time']"
										},
										"sink": {
											"name": "default_end_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['default_shift_break_duration']"
										},
										"sink": {
											"name": "default_shift_break_duration",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['default_start_time']"
										},
										"sink": {
											"name": "default_start_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['is_unpaid_absence_with_shifts']"
										},
										"sink": {
											"name": "is_unpaid_absence_with_shifts",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['night_shift']"
										},
										"sink": {
											"name": "night_shift",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['peak_shift']"
										},
										"sink": {
											"name": "peak_shift",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['timesheet_required']"
										},
										"sink": {
											"name": "timesheet_required",
											"type": "String"
										}
									}
								],
								"collectionReference": "",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "shift_types - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_ShiftTypes"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_TypesOfWork')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TypesOfWork",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "TypesOfWork_id"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									}
								],
								"collectionReference": "",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "types_of_work - All Pages.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_TypesOfWork"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Initial_Users')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Users",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['organisation_user_id']"
										},
										"sink": {
											"name": "organisation_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['external_id']"
										},
										"sink": {
											"name": "external_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['active']"
										},
										"sink": {
											"name": "active",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['state']"
										},
										"sink": {
											"name": "state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['first_name']"
										},
										"sink": {
											"name": "first_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['legal_first_name']"
										},
										"sink": {
											"name": "legal_first_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['middle_name']"
										},
										"sink": {
											"name": "middle_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['last_name']"
										},
										"sink": {
											"name": "last_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['administrative_org_unit']['id']"
										},
										"sink": {
											"name": "administrative_org_unit_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['exclude_from_payroll']"
										},
										"sink": {
											"name": "exclude_from_payroll",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['marital_status']"
										},
										"sink": {
											"name": "marital_status",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['work_email']"
										},
										"sink": {
											"name": "work_email",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['date_of_birth']"
										},
										"sink": {
											"name": "date_of_birth",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['preferred_name']"
										},
										"sink": {
											"name": "preferred_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['final_date_of_employment']"
										},
										"sink": {
											"name": "final_date_of_employment",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['identifies_as']"
										},
										"sink": {
											"name": "identifies_as",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['title']"
										},
										"sink": {
											"name": "title",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['sex']"
										},
										"sink": {
											"name": "sex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['agency']['id']"
										},
										"sink": {
											"name": "agency_id",
											"type": "String"
										}
									}
								],
								"collectionReference": ""
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "users - All Pages (minus pg 10).json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_Users"
								}
							}
						]
					},
					{
						"name": "Users_types_of_work",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Users",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['organisation_user_id']"
										},
										"sink": {
											"name": "organisation_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "user_types_pf_work_ido",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['types_of_work']"
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Initial_File",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "users - All Pages (minus pg 10).json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_Users_Types_Of_work"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Migration_Sources')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Ucheck Data Dump",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Ucheck_dataDump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "SonaMigration",
									"Table": "UcheckDataDump"
								}
							}
						]
					},
					{
						"name": "Copy CB RTW Report",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Home Name ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "HomeName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Employee",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Employee",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Created",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Created",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Item",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Item",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reference",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Reference",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Review",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Review",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Requested",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Requested",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Received",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Received",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Expires",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Expires",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_CB_RTW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "SonaMigration",
									"Table": "CB_RTW"
								}
							}
						]
					},
					{
						"name": "Avery Immigration File",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Avery_Immigration_file",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "SonaMigration",
									"Table": "AveryImmigrationData"
								}
							}
						]
					},
					{
						"name": "Copy Verifle RTW data",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Verifile_RTW_Data",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "SonaMigration",
									"Table": "Verifile_RTWData"
								}
							}
						]
					},
					{
						"name": "Copy Verifile DBS Data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "VF Number",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "VF Number",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Applicant First Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Applicant First Name",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Applicant Last Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Applicant Last Name",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Check Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Check Name",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Criminal Disclosure Application No.",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Criminal Disclosure Application No.",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Completion Date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Completion Date",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Check Result",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Check Result",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Verifile_DBS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "SonaMigration",
									"Table": "VerifileDBSData"
								}
							}
						]
					},
					{
						"name": "Sona RTW Mapping",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_RTW_Mapping",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "SonaMigration",
									"Table": "Sona_RTW_Mapping"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_PayLines')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PayLines",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "PayLines_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['comment']"
										},
										"sink": {
											"name": "comment",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['entry_type']"
										},
										"sink": {
											"name": "entry_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['variant']"
										},
										"sink": {
											"name": "variant",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['user_id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['duration_in_minutes']"
										},
										"sink": {
											"name": "duration_in_minutes",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['start_datetime']"
										},
										"sink": {
											"name": "start_datetime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['end_datetime']"
										},
										"sink": {
											"name": "end_datetime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['is_sleep']"
										},
										"sink": {
											"name": "is_sleep",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['shift_id']"
										},
										"sink": {
											"name": "shift_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['pay_type']"
										},
										"sink": {
											"name": "pay_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rate_of_pay']['id']"
										},
										"sink": {
											"name": "rate_of_pay_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rate_of_pay']['rate']"
										},
										"sink": {
											"name": "rate",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rate_of_pay']['pay_type']"
										},
										"sink": {
											"name": "rate_of_pay_pay_type",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['entries']"
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Json",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "pay_lines 17-11 to 23-11.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_PayLines"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_Upsert_WeeklyHr_data')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upserts the shifts and payroll data",
				"activities": [
					{
						"name": "Upsert Paylines",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set DateString",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"PayLines_id"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "PayLines_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['comment']"
										},
										"sink": {
											"name": "comment",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['entry_type']"
										},
										"sink": {
											"name": "entry_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['variant']"
										},
										"sink": {
											"name": "variant",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['user_id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['duration_in_minutes']"
										},
										"sink": {
											"name": "duration_in_minutes",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['end_datetime']"
										},
										"sink": {
											"name": "end_datetime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['start_datetime']"
										},
										"sink": {
											"name": "start_datetime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_id']"
										},
										"sink": {
											"name": "shift_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['is_sleep']"
										},
										"sink": {
											"name": "is_sleep",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['pay_type']"
										},
										"sink": {
											"name": "pay_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rate_of_pay']['id']"
										},
										"sink": {
											"name": "rate_of_pay_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rate_of_pay']['rate']"
										},
										"sink": {
											"name": "rate",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rate_of_pay']['pay_type']"
										},
										"sink": {
											"name": "rate_of_pay_pay_type",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['entries']"
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Json_WeeklyHrs",
								"type": "DatasetReference",
								"parameters": {
									"FileName": "paylines$",
									"DateString": {
										"value": "@variables('DateString')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_PayLines"
								}
							}
						]
					},
					{
						"name": "Set DateString",
						"description": "Sets the date string used for Dataset property",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DateString",
							"value": {
								"value": "@utcNow('yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Upsert Shifts",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set DateString",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"shift_id"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "shift_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['description']"
										},
										"sink": {
											"name": "description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['category']"
										},
										"sink": {
											"name": "category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['org_unit']['id']"
										},
										"sink": {
											"name": "shifts_org_unit_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['start_datetime']"
										},
										"sink": {
											"name": "start_datetime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['agency']['id']"
										},
										"sink": {
											"name": "agency_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_type']['id']"
										},
										"sink": {
											"name": "shifts_shift_type_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_type']['name']"
										},
										"sink": {
											"name": "shifts_shift_type_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['finish_datetime']"
										},
										"sink": {
											"name": "finish_datetime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['internal_id']"
										},
										"sink": {
											"name": "internal_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['user_working_shift']['id']"
										},
										"sink": {
											"name": "user_working_shift_id",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['entries']"
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Json_WeeklyHrs",
								"type": "DatasetReference",
								"parameters": {
									"FileName": "shifts$",
									"DateString": {
										"value": "@variables('DateString')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_Shifts"
								}
							}
						]
					},
					{
						"name": "Shifts_shift_breaks",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Upsert Shifts",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"shift_id",
										"break_id"
									]
								},
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "shift_id"
										}
									},
									{
										"source": {
											"path": "[['shift_breaks'][0]['break']['id']"
										},
										"sink": {
											"name": "break_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_breaks'][0]['break']['duration']"
										},
										"sink": {
											"name": "duration",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['entries']"
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Json_WeeklyHrs",
								"type": "DatasetReference",
								"parameters": {
									"FileName": "shifts$",
									"DateString": {
										"value": "@variables('DateString')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_Shifts_Shift_Breaks"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"DateString": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Sona/Child Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Sona_shifts')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Shifts",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "shift_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['description']"
										},
										"sink": {
											"name": "description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['category']"
										},
										"sink": {
											"name": "category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['org_unit']['id']"
										},
										"sink": {
											"name": "shifts_org_unit_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['start_datetime']"
										},
										"sink": {
											"name": "start_datetime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_type']['id']"
										},
										"sink": {
											"name": "shifts_shift_type_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_type']['name']"
										},
										"sink": {
											"name": "shifts_shift_type_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['finish_datetime']"
										},
										"sink": {
											"name": "finish_datetime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['internal_id']"
										},
										"sink": {
											"name": "internal_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['user_working_shift']['id']"
										},
										"sink": {
											"name": "user_working_shift_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['agency']['id']"
										},
										"sink": {
											"name": "agency_id",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['entries']"
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Json",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "shifts 17-11 to 23-11.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_Shifts"
								}
							}
						]
					},
					{
						"name": "Shifts_shift_breaks",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Shifts",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "shift_id"
										}
									},
									{
										"source": {
											"path": "[['shift_breaks'][0]['break']['id']"
										},
										"sink": {
											"name": "break_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_breaks'][0]['break']['duration']"
										},
										"sink": {
											"name": "duration",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['entries']"
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Sona_Json",
								"type": "DatasetReference",
								"parameters": {
									"Filename": "shifts 17-11 to 23-11.json"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Sona",
									"Table": "STG_Shifts_Shift_Breaks"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Sona/Initial API Files"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Transform_HomeDetails')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Home Details",
						"description": "Copys the various Home Details from Avery DB vHomeDetails to TRANSFORM_DB HomeDetails",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"HomeID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "HomeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "HomeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "IntranetID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "IntranetID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "HomeName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Homename",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "HomeTypeName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HomeTypeName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "HomeStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HomeStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BedCount",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BedCount",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Group",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Group",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SubGroup",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SubGroup",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Division",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Division",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DivisionAltName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DivisionAltName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Postcode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Postcode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ColdHarbourHOME_REF",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ColdHarbourHOME_REF",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ExchCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ExchCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CHCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CHCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CareBloxHomeid",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CareBloxHomeID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CBCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CBCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "HomeManager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HomeManager",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ManagerEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ManagerEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DeputyEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DeputyEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AdminEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "AdminEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CSMEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CSMEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RegionalDirector",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RegionalDirector",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RegionalDirectorEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RegionalDirectorEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OpsDirector",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OpsDirector",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OpsDirectorEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OpsDirectorEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorporateBudget",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorporateBudget",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StretchBudget",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StretchBudget",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "YearEnd",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "YearEnd",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_AH2_Avery",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "Avery",
									"Table": "VHomeDetails"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB_Avery_HomeDetails",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Avery/Children Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2024-10-10T08:27:28Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Yardi_AEMS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Look up Values",
						"type": "Lookup",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT HOME_REF, HomeName, IntranetID FROM ColdHarbourHomeID WHERE HOME_REF = '@{variables('Home_Ref')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_AH2_YardiStage",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "n/a",
									"Table": "n/a"
								}
							}
						}
					},
					{
						"name": "AEMS Enquiry",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set HomeName",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set IntranetID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT\n    ID\n    ,AEMS_ID\n    ,aems_version\n    ,homeID\n    ,uploadedBy\n    ,managerEmailed\n    ,enquiryStatus\n    ,enquiryID\n    ,initialEnquiry\n    ,enquirerSalutation\n    ,enquirerLastName AS enquirerFirstName\n    ,enquirerFirstName AS enquirerLastName \n    ,enquirerSalutationTwo\n    ,enquirerLastNameTwo \n    ,enquirerFirstNameTwo \n    ,enquiryDate\n    ,enquirerRelationshipToResident\n    ,en_areacode\n    ,enquirerTelephone \n    ,enquiry_mobile \n    ,enquirerEmail \n    ,enquirerAddress  AS nokAddress\n    ,enquirerAddressOne AS nokAddressOne\n    ,enquirerAddressTwo  AS nokAddressTwo\n    ,enquirerAddressThree  AS nokAddressThree \n    ,enquiry_postcode \n    ,enquiry_postcode_two \n    ,residentSalutation\n    ,residentFirstName \n    ,residentLastName \n    ,residentDOB \n    ,residentSalutationTwo\n    ,residentFirstNameTwo\n    ,residentLastNameTwo\n    ,residentDOBTwo\n    ,residentNOK\n    ,residentAddress \n    ,residentAddressOne \n    ,residentAddressTwo \n    ,residentAddressThree \n    ,residentPostcode \n    ,residentTelephone \n    ,residentCareCategory\n    ,residentFundingCategory\n    ,residentCareCategoryTwo\n    ,funding_total\n    ,residentFunding\n    ,residentFundingTwo\n    --,enquiryDetails \n    ,REPLACE(CONVERT(VARCHAR(MAX), enquiryDetails), '\"', '') AS enquiryDetails\n    ,enquiryType\n    ,responseTime\n    ,responseCurrentStatus\n    ,responseNeeded\n    ,responseAmountTried\n    ,followUpDate\n    ,followUpReason\n    ,uploadToCH\n    ,admissionDate\n    ,enquiryClosed\n    ,managerContacted\n    ,homeVisit\n    ,assessmentBooked\n    ,assesmentComplete\n    ,admission\n    ,homeVisitBooked\n    ,admissionBooked\n    ,video_booked\n    ,video_complete\n    ,homeVisitRequested\n    ,assesmentRequested\n    ,newEnquiry\n    ,cameFrom\n    ,enquirer_address \n    ,enquirer_postcode \n    ,lng\n    ,lat\n    ,enquirer_area\n    ,enquirer_county\n    ,nok_name\n    ,nok_surname\n    ,nok_county\n    ,nok_relation\n    ,nok_telephone\n    ,nok_mobile\n    ,nok_address\n    ,resident_county\n    ,nok_Salutation\n    ,newsletter_receive\n    ,newsletter_email\n    ,enquiry_urgent\n    ,optOut\n    ,type_news\n    ,type_mag\n    ,type_other\n    ,gp_name\n    ,gp_address\n    ,gp_telephone\n    ,gp_requested\n    ,gp_received\n    ,website\n    ,brochure\n    ,brochure_requestID\n    ,entryMethod\n    ,current_action_id\n    ,column_hash\n    ,receiveMarketing\n    ,willTopUp\n    ,enquiry_entered_from\n    ,enquiry_closed_reason\n    ,enquiry_deleted\n    ,enquiry_weight\nFROM \n    AEMS.AEMS_Enquiries AS E\nWHERE \n    E.homeID IN (@{variables('IntranetID')})",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "n/a",
									"Table": "n/a"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Yardi_CSV",
								"type": "DatasetReference",
								"parameters": {
									"Filename": {
										"value": "@concat('AEMS Enquiry - ', utcNow('yyyy-MM-dd'), '.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set HomeName",
						"type": "SetVariable",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Look up Values",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "HomeName",
							"value": {
								"value": "@activity('Look up Values').output.firstRow.HomeName",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set IntranetID",
						"type": "SetVariable",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Look up Values",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "IntranetID",
							"value": {
								"value": "@activity('Look up Values').output.firstRow.IntranetID",
								"type": "Expression"
							}
						}
					},
					{
						"name": "AEMS Enquiry Actions",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "AEMS Enquiry",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \n    A.ID\n    ,A.AEMS_ID\n    ,enquiry_setBy\n    ,enquiry_id\n    ,enquiry_dateRequired\n    ,enquiry_reason\n    ,enquiry_contact\n    ,enquiry_actionComplete\n    ,enquiry_actionInserted\n    ,enquiry_actionCompleteDate\n    ,enquiry_actionCompleteBy\n    ,enquiry_homeID\n    ,enquiry_missed\n    ,enquiry_missedEmail\n    ,enquiry_missedEmailDate\n    ,enquiry_initialContact\n    ,enquiry_flag\n    ,enquiry_critical\n    --,REPLACE(enquiry_details, '\"', '')\n    ,REPLACE(CONVERT(VARCHAR(MAX), enquiry_details), '\"', '') AS enquiry_details\n    ,enquiry_picked_up\n    ,enquiry_assigned_to\n    ,enquiry_assigned_when\n    ,enquiry_action_call_handler\n    ,enquiry_new\nFROM \n    AEMS.AEMS_Enquiries_Actions AS A\n\n    INNER JOIN AEMS.AEMS_Enquiries AS E\n        ON E.AEMS_ID = A.enquiry_id\n        AND E.homeID = A.enquiry_homeID\n    WHERE\n        A.enquiry_homeID IN (@{variables('IntranetID')})\n        ",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_AH2_TRANSFORM_DB",
								"type": "DatasetReference",
								"parameters": {
									"Schema": "n/a",
									"Table": "n/a"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Yardi_CSV",
								"type": "DatasetReference",
								"parameters": {
									"Filename": {
										"value": "@concat('AEMS Enquiry Actions - ', utcNow('yyyy-MM-dd'), '.csv')",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Home_Ref": {
						"type": "String",
						"defaultValue": "611"
					},
					"HomeName": {
						"type": "String"
					},
					"IntranetID": {
						"type": "String",
						"defaultValue": "7581,83,7596,7598"
					}
				},
				"folder": {
					"name": "Yardi/AEMS"
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}