{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "Avery-ADF"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/DS_BroadShield_Live_API_AllData')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Broadshields live API. No Date Filter",
				"linkedServiceName": {
					"referenceName": "Broadshield Live API",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"EndPoint": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Broadshield/NoDateFilter"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().EndPoint)",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_BroadShield_UAT_API')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Broadshield UAT API endpoint. Requires the endpoint and fromdate parameter to be enter. (YYYYMMDDHHmmss)",
				"linkedServiceName": {
					"referenceName": "Myrus_Careshield_UAT_API",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Date": {
						"type": "string"
					},
					"EndPoint": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Broadshield"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().EndPoint,'fromDate=', dataset().Date)",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_BroadShield_UAT_API_AllData')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Myrus_Careshield_UAT_API",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"EndPoint": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Broadshield/NoDateFilter"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().EndPoint)",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CQC_CustomLocationJSONSchema')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "CQC"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "CustomLocationJsonSchema.json",
						"folderPath": "customjsonschema",
						"container": "cqc"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"locationId": {
							"type": "string"
						},
						"providerId": {
							"type": "string"
						},
						"organisationType": {
							"type": "string"
						},
						"type": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"brandId": {
							"type": "string"
						},
						"brandName": {
							"type": "string"
						},
						"onspdCcgCode": {
							"type": "string"
						},
						"onspdCcgName": {
							"type": "string"
						},
						"onspdIcbCode": {
							"type": "string"
						},
						"onspdIcbName": {
							"type": "string"
						},
						"odsCode": {
							"type": "string"
						},
						"registrationStatus": {
							"type": "string"
						},
						"registrationDate": {
							"type": "string"
						},
						"dormancy": {
							"type": "string"
						},
						"onspdLatitude": {
							"type": "number"
						},
						"onspdLongitude": {
							"type": "number"
						},
						"careHome": {
							"type": "string"
						},
						"inspectionDirectorate": {
							"type": "string"
						},
						"postalAddressLine1": {
							"type": "string"
						},
						"postalAddressTownCity": {
							"type": "string"
						},
						"postalAddressCounty": {
							"type": "string"
						},
						"region": {
							"type": "string"
						},
						"postalCode": {
							"type": "string"
						},
						"uprn": {
							"type": "string"
						},
						"mainPhoneNumber": {
							"type": "string"
						},
						"registeredManagerAbsentDate": {
							"type": "string"
						},
						"website": {
							"type": "string"
						},
						"numberOfBeds": {
							"type": "integer"
						},
						"constituency": {
							"type": "string"
						},
						"localAuthority": {
							"type": "string"
						},
						"lastInspection": {
							"type": "object",
							"properties": {
								"date": {
									"type": "string"
								}
							}
						},
						"lastReport": {
							"type": "object",
							"properties": {
								"publicationDate": {
									"type": "string"
								}
							}
						},
						"historicRatings": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"reportDate": {
										"type": "string"
									},
									"reportLinkId": {
										"type": "string"
									},
									"overall": {
										"type": "object",
										"properties": {
											"rating": {
												"type": "string"
											},
											"keyQuestionRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"name": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														}
													}
												}
											}
										}
									}
								}
							}
						},
						"currentRatings": {
							"type": "object",
							"properties": {
								"overall": {
									"type": "object",
									"properties": {
										"rating": {
											"type": "string"
										},
										"reportDate": {
											"type": "string"
										},
										"reportLinkId": {
											"type": "string"
										},
										"keyQuestionRatings": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"name": {
														"type": "string"
													},
													"rating": {
														"type": "string"
													},
													"reportDate": {
														"type": "string"
													},
													"reportLinkId": {
														"type": "string"
													}
												}
											}
										}
									}
								},
								"reportDate": {
									"type": "string"
								}
							}
						},
						"assessment": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"assessmentPlanPublishedDateTime": {
										"type": "string"
									},
									"ratings": {
										"type": "object",
										"properties": {
											"asgRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"assessmentPlanId": {
															"type": "string"
														},
														"title": {
															"type": "string"
														},
														"assessmentDate": {
															"type": "string"
														},
														"assessmentPlanStatus": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														},
														"status": {
															"type": "string"
														},
														"narrative": {
															"type": "string"
														},
														"keyQuestionRatings": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"name": {
																		"type": "string"
																	},
																	"rating": {
																		"type": "string"
																	},
																	"status": {
																		"type": "string"
																	},
																	"narrative": {
																		"type": "string"
																	},
																	"percentageScore": {
																		"type": "string"
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CQC_CustomProviderJSONSchema')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "CQC"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "CustomProviderJsonSchema.json",
						"folderPath": "customjsonschema",
						"container": "cqc"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"locationId": {
							"type": "string"
						},
						"providerId": {
							"type": "string"
						},
						"organisationType": {
							"type": "string"
						},
						"type": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"brandId": {
							"type": "string"
						},
						"brandName": {
							"type": "string"
						},
						"onspdCcgCode": {
							"type": "string"
						},
						"onspdCcgName": {
							"type": "string"
						},
						"onspdIcbCode": {
							"type": "string"
						},
						"onspdIcbName": {
							"type": "string"
						},
						"odsCode": {
							"type": "string"
						},
						"registrationStatus": {
							"type": "string"
						},
						"registrationDate": {
							"type": "string"
						},
						"dormancy": {
							"type": "string"
						},
						"onspdLatitude": {
							"type": "number"
						},
						"onspdLongitude": {
							"type": "number"
						},
						"careHome": {
							"type": "string"
						},
						"inspectionDirectorate": {
							"type": "string"
						},
						"postalAddressLine1": {
							"type": "string"
						},
						"postalAddressTownCity": {
							"type": "string"
						},
						"postalAddressCounty": {
							"type": "string"
						},
						"region": {
							"type": "string"
						},
						"postalCode": {
							"type": "string"
						},
						"uprn": {
							"type": "string"
						},
						"mainPhoneNumber": {
							"type": "string"
						},
						"registeredManagerAbsentDate": {
							"type": "string"
						},
						"website": {
							"type": "string"
						},
						"numberOfBeds": {
							"type": "integer"
						},
						"constituency": {
							"type": "string"
						},
						"localAuthority": {
							"type": "string"
						},
						"lastInspection": {
							"type": "object",
							"properties": {
								"date": {
									"type": "string"
								}
							}
						},
						"lastReport": {
							"type": "object",
							"properties": {
								"publicationDate": {
									"type": "string"
								}
							}
						},
						"historicRatings": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"reportDate": {
										"type": "string"
									},
									"reportLinkId": {
										"type": "string"
									},
									"overall": {
										"type": "object",
										"properties": {
											"rating": {
												"type": "string"
											},
											"keyQuestionRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"name": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														}
													}
												}
											}
										}
									}
								}
							}
						},
						"currentRatings": {
							"type": "object",
							"properties": {
								"overall": {
									"type": "object",
									"properties": {
										"rating": {
											"type": "string"
										},
										"reportDate": {
											"type": "string"
										},
										"reportLinkId": {
											"type": "string"
										},
										"keyQuestionRatings": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"name": {
														"type": "string"
													},
													"rating": {
														"type": "string"
													},
													"reportDate": {
														"type": "string"
													},
													"reportLinkId": {
														"type": "string"
													}
												}
											}
										}
									}
								},
								"reportDate": {
									"type": "string"
								}
							}
						},
						"assessment": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"assessmentPlanPublishedDateTime": {
										"type": "string"
									},
									"ratings": {
										"type": "object",
										"properties": {
											"asgRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"assessmentPlanId": {
															"type": "string"
														},
														"title": {
															"type": "string"
														},
														"assessmentDate": {
															"type": "string"
														},
														"assessmentPlanStatus": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														},
														"status": {
															"type": "string"
														},
														"narrative": {
															"type": "string"
														},
														"keyQuestionRatings": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"name": {
																		"type": "string"
																	},
																	"rating": {
																		"type": "string"
																	},
																	"status": {
																		"type": "string"
																	},
																	"narrative": {
																		"type": "string"
																	},
																	"percentageScore": {
																		"type": "string"
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CQC_HomeLocationList')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "CQC"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "HomeLocationIDs.json",
						"folderPath": "locationlist",
						"container": "cqc"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"locationId": {
							"type": "string"
						},
						"providerId": {
							"type": "string"
						},
						"organisationType": {
							"type": "string"
						},
						"type": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"brandId": {
							"type": "string"
						},
						"brandName": {
							"type": "string"
						},
						"onspdCcgCode": {
							"type": "string"
						},
						"onspdCcgName": {
							"type": "string"
						},
						"onspdIcbCode": {
							"type": "string"
						},
						"onspdIcbName": {
							"type": "string"
						},
						"odsCode": {
							"type": "string"
						},
						"registrationStatus": {
							"type": "string"
						},
						"registrationDate": {
							"type": "string"
						},
						"dormancy": {
							"type": "string"
						},
						"onspdLatitude": {
							"type": "number"
						},
						"onspdLongitude": {
							"type": "number"
						},
						"careHome": {
							"type": "string"
						},
						"inspectionDirectorate": {
							"type": "string"
						},
						"postalAddressLine1": {
							"type": "string"
						},
						"postalAddressTownCity": {
							"type": "string"
						},
						"postalAddressCounty": {
							"type": "string"
						},
						"region": {
							"type": "string"
						},
						"postalCode": {
							"type": "string"
						},
						"uprn": {
							"type": "string"
						},
						"mainPhoneNumber": {
							"type": "string"
						},
						"registeredManagerAbsentDate": {
							"type": "string"
						},
						"website": {
							"type": "string"
						},
						"numberOfBeds": {
							"type": "integer"
						},
						"constituency": {
							"type": "string"
						},
						"localAuthority": {
							"type": "string"
						},
						"lastInspection": {
							"type": "object",
							"properties": {
								"date": {
									"type": "string"
								}
							}
						},
						"lastReport": {
							"type": "object",
							"properties": {
								"publicationDate": {
									"type": "string"
								}
							}
						},
						"relationships": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"relatedLocationId": {
										"type": "string"
									},
									"relatedLocationName": {
										"type": "string"
									},
									"type": {
										"type": "string"
									},
									"reason": {
										"type": "string"
									}
								}
							}
						},
						"locationTypes": {
							"type": "array"
						},
						"regulatedActivities": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"name": {
										"type": "string"
									},
									"code": {
										"type": "string"
									},
									"contacts": {
										"type": "array"
									}
								}
							}
						},
						"gacServiceTypes": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"name": {
										"type": "string"
									},
									"description": {
										"type": "string"
									}
								}
							}
						},
						"specialisms": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"name": {
										"type": "string"
									}
								}
							}
						},
						"inspectionCategories": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"code": {
										"type": "string"
									},
									"primary": {
										"type": "string"
									},
									"name": {
										"type": "string"
									}
								}
							}
						},
						"inspectionAreas": {
							"type": "array"
						},
						"historicRatings": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"reportDate": {
										"type": "string"
									},
									"reportLinkId": {
										"type": "string"
									},
									"overall": {
										"type": "object",
										"properties": {
											"rating": {
												"type": "string"
											},
											"keyQuestionRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"name": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														}
													}
												}
											}
										}
									}
								}
							}
						},
						"reports": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"linkId": {
										"type": "string"
									},
									"reportDate": {
										"type": "string"
									},
									"firstVisitDate": {
										"type": "string"
									},
									"reportUri": {
										"type": "string"
									},
									"reportType": {
										"type": "string"
									}
								}
							}
						},
						"assessmentServiceGroup": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"assessmentServiceId": {
										"type": "string"
									},
									"assessmentServiceName": {
										"type": "string"
									},
									"status": {
										"type": "string"
									}
								}
							}
						},
						"assessment": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"assessmentPlanPublishedDateTime": {
										"type": "string"
									},
									"ratings": {
										"type": "object",
										"properties": {
											"asgRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"assessmentPlanId": {
															"type": "string"
														},
														"title": {
															"type": "string"
														},
														"assessmentDate": {
															"type": "string"
														},
														"assessmentPlanStatus": {
															"type": "string"
														},
														"name": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														},
														"status": {
															"type": "string"
														},
														"commentary": {
															"type": "string"
														},
														"commentaryDate": {
															"type": "string"
														},
														"narrative": {
															"type": "string"
														},
														"overallPeopleExperience": {
															"type": "string"
														},
														"overallPeopleExperienceDate": {
															"type": "string"
														},
														"keyQuestionRatings": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"name": {
																		"type": "string"
																	},
																	"rating": {
																		"type": "string"
																	},
																	"status": {
																		"type": "string"
																	},
																	"commentary": {
																		"type": "string"
																	},
																	"commentaryDate": {
																		"type": "string"
																	},
																	"narrative": {
																		"type": "string"
																	},
																	"percentageScore": {
																		"type": "string"
																	},
																	"topicareas": {
																		"type": "array",
																		"items": {
																			"type": "object",
																			"properties": {
																				"name": {
																					"type": "string"
																				},
																				"qualityStatementId": {
																					"type": "string"
																				},
																				"status": {
																					"type": "string"
																				},
																				"evidenceCategory": {
																					"type": "array",
																					"items": {
																						"type": "object",
																						"properties": {
																							"evidenceCategoryId": {
																								"type": "string"
																							},
																							"commentary": {
																								"type": "string"
																							},
																							"commentaryDate": {
																								"type": "string"
																							}
																						}
																					}
																				},
																				"qualityStatementscore": {
																					"type": "string"
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CQC_Merged_Location_File')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "CQC"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@concat('locationresponses', '/', formatDateTime(utcNow(), 'yyyy'),'/',formatDateTime(utcNow(), 'MM'),'/',formatDateTime(utcNow(), 'dd'), '/', 'merged')",
							"type": "Expression"
						},
						"container": "cqc"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"locationId": {
							"type": "string"
						},
						"providerId": {
							"type": "string"
						},
						"organisationType": {
							"type": "string"
						},
						"type": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"brandId": {
							"type": "string"
						},
						"brandName": {
							"type": "string"
						},
						"onspdCcgCode": {
							"type": "string"
						},
						"onspdCcgName": {
							"type": "string"
						},
						"onspdIcbCode": {
							"type": "string"
						},
						"onspdIcbName": {
							"type": "string"
						},
						"odsCode": {
							"type": "string"
						},
						"registrationStatus": {
							"type": "string"
						},
						"registrationDate": {
							"type": "string"
						},
						"dormancy": {
							"type": "string"
						},
						"onspdLatitude": {
							"type": "number"
						},
						"onspdLongitude": {
							"type": "number"
						},
						"careHome": {
							"type": "string"
						},
						"inspectionDirectorate": {
							"type": "string"
						},
						"postalAddressLine1": {
							"type": "string"
						},
						"postalAddressTownCity": {
							"type": "string"
						},
						"postalAddressCounty": {
							"type": "string"
						},
						"region": {
							"type": "string"
						},
						"postalCode": {
							"type": "string"
						},
						"uprn": {
							"type": "string"
						},
						"mainPhoneNumber": {
							"type": "string"
						},
						"registeredManagerAbsentDate": {
							"type": "string"
						},
						"website": {
							"type": "string"
						},
						"numberOfBeds": {
							"type": "integer"
						},
						"constituency": {
							"type": "string"
						},
						"localAuthority": {
							"type": "string"
						},
						"lastInspection": {
							"type": "object",
							"properties": {
								"date": {
									"type": "string"
								}
							}
						},
						"lastReport": {
							"type": "object",
							"properties": {
								"publicationDate": {
									"type": "string"
								}
							}
						},
						"historicRatings": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"reportDate": {
										"type": "string"
									},
									"reportLinkId": {
										"type": "string"
									},
									"overall": {
										"type": "object",
										"properties": {
											"rating": {
												"type": "string"
											},
											"keyQuestionRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"name": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														}
													}
												}
											}
										}
									}
								}
							}
						},
						"currentRatings": {
							"type": "object",
							"properties": {
								"overall": {
									"type": "object",
									"properties": {
										"rating": {
											"type": "string"
										},
										"reportDate": {
											"type": "string"
										},
										"reportLinkId": {
											"type": "string"
										},
										"keyQuestionRatings": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"name": {
														"type": "string"
													},
													"rating": {
														"type": "string"
													},
													"reportDate": {
														"type": "string"
													},
													"reportLinkId": {
														"type": "string"
													}
												}
											}
										}
									}
								},
								"reportDate": {
									"type": "string"
								}
							}
						},
						"assessment": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"assessmentPlanPublishedDateTime": {
										"type": "string"
									},
									"ratings": {
										"type": "object",
										"properties": {
											"asgRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"assessmentPlanId": {
															"type": "string"
														},
														"title": {
															"type": "string"
														},
														"assessmentDate": {
															"type": "string"
														},
														"assessmentPlanStatus": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														},
														"status": {
															"type": "string"
														},
														"narrative": {
															"type": "string"
														},
														"keyQuestionRatings": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"name": {
																		"type": "string"
																	},
																	"rating": {
																		"type": "string"
																	},
																	"status": {
																		"type": "string"
																	},
																	"narrative": {
																		"type": "string"
																	},
																	"percentageScore": {
																		"type": "string"
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CQC_Merged_Provider_File')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "CQC"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@concat('providerresponses', '/', formatDateTime(utcNow(), 'yyyy'),'/',formatDateTime(utcNow(), 'MM'),'/',formatDateTime(utcNow(), 'dd'), '/', 'merged')",
							"type": "Expression"
						},
						"container": "cqc"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"locationId": {
							"type": "string"
						},
						"providerId": {
							"type": "string"
						},
						"organisationType": {
							"type": "string"
						},
						"type": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"brandId": {
							"type": "string"
						},
						"brandName": {
							"type": "string"
						},
						"onspdCcgCode": {
							"type": "string"
						},
						"onspdCcgName": {
							"type": "string"
						},
						"onspdIcbCode": {
							"type": "string"
						},
						"onspdIcbName": {
							"type": "string"
						},
						"odsCode": {
							"type": "string"
						},
						"registrationStatus": {
							"type": "string"
						},
						"registrationDate": {
							"type": "string"
						},
						"dormancy": {
							"type": "string"
						},
						"onspdLatitude": {
							"type": "number"
						},
						"onspdLongitude": {
							"type": "number"
						},
						"careHome": {
							"type": "string"
						},
						"inspectionDirectorate": {
							"type": "string"
						},
						"postalAddressLine1": {
							"type": "string"
						},
						"postalAddressTownCity": {
							"type": "string"
						},
						"postalAddressCounty": {
							"type": "string"
						},
						"region": {
							"type": "string"
						},
						"postalCode": {
							"type": "string"
						},
						"uprn": {
							"type": "string"
						},
						"mainPhoneNumber": {
							"type": "string"
						},
						"registeredManagerAbsentDate": {
							"type": "string"
						},
						"website": {
							"type": "string"
						},
						"numberOfBeds": {
							"type": "integer"
						},
						"constituency": {
							"type": "string"
						},
						"localAuthority": {
							"type": "string"
						},
						"lastInspection": {
							"type": "object",
							"properties": {
								"date": {
									"type": "string"
								}
							}
						},
						"lastReport": {
							"type": "object",
							"properties": {
								"publicationDate": {
									"type": "string"
								}
							}
						},
						"historicRatings": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"reportDate": {
										"type": "string"
									},
									"reportLinkId": {
										"type": "string"
									},
									"overall": {
										"type": "object",
										"properties": {
											"rating": {
												"type": "string"
											},
											"keyQuestionRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"name": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														}
													}
												}
											}
										}
									}
								}
							}
						},
						"currentRatings": {
							"type": "object",
							"properties": {
								"overall": {
									"type": "object",
									"properties": {
										"rating": {
											"type": "string"
										},
										"reportDate": {
											"type": "string"
										},
										"reportLinkId": {
											"type": "string"
										},
										"keyQuestionRatings": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"name": {
														"type": "string"
													},
													"rating": {
														"type": "string"
													},
													"reportDate": {
														"type": "string"
													},
													"reportLinkId": {
														"type": "string"
													}
												}
											}
										}
									}
								},
								"reportDate": {
									"type": "string"
								}
							}
						},
						"assessment": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"assessmentPlanPublishedDateTime": {
										"type": "string"
									},
									"ratings": {
										"type": "object",
										"properties": {
											"asgRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"assessmentPlanId": {
															"type": "string"
														},
														"title": {
															"type": "string"
														},
														"assessmentDate": {
															"type": "string"
														},
														"assessmentPlanStatus": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														},
														"status": {
															"type": "string"
														},
														"narrative": {
															"type": "string"
														},
														"keyQuestionRatings": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"name": {
																		"type": "string"
																	},
																	"rating": {
																		"type": "string"
																	},
																	"status": {
																		"type": "string"
																	},
																	"narrative": {
																		"type": "string"
																	},
																	"percentageScore": {
																		"type": "string"
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CQC_ProviderList')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "CQC"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "ProviderIDs.json",
						"folderPath": "providerlist",
						"container": "cqc"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"locationId": {
							"type": "string"
						},
						"providerId": {
							"type": "string"
						},
						"organisationType": {
							"type": "string"
						},
						"type": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"brandId": {
							"type": "string"
						},
						"brandName": {
							"type": "string"
						},
						"onspdCcgCode": {
							"type": "string"
						},
						"onspdCcgName": {
							"type": "string"
						},
						"onspdIcbCode": {
							"type": "string"
						},
						"onspdIcbName": {
							"type": "string"
						},
						"odsCode": {
							"type": "string"
						},
						"registrationStatus": {
							"type": "string"
						},
						"registrationDate": {
							"type": "string"
						},
						"dormancy": {
							"type": "string"
						},
						"onspdLatitude": {
							"type": "number"
						},
						"onspdLongitude": {
							"type": "number"
						},
						"careHome": {
							"type": "string"
						},
						"inspectionDirectorate": {
							"type": "string"
						},
						"postalAddressLine1": {
							"type": "string"
						},
						"postalAddressTownCity": {
							"type": "string"
						},
						"postalAddressCounty": {
							"type": "string"
						},
						"region": {
							"type": "string"
						},
						"postalCode": {
							"type": "string"
						},
						"uprn": {
							"type": "string"
						},
						"mainPhoneNumber": {
							"type": "string"
						},
						"registeredManagerAbsentDate": {
							"type": "string"
						},
						"website": {
							"type": "string"
						},
						"numberOfBeds": {
							"type": "integer"
						},
						"constituency": {
							"type": "string"
						},
						"localAuthority": {
							"type": "string"
						},
						"lastInspection": {
							"type": "object",
							"properties": {
								"date": {
									"type": "string"
								}
							}
						},
						"lastReport": {
							"type": "object",
							"properties": {
								"publicationDate": {
									"type": "string"
								}
							}
						},
						"relationships": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"relatedLocationId": {
										"type": "string"
									},
									"relatedLocationName": {
										"type": "string"
									},
									"type": {
										"type": "string"
									},
									"reason": {
										"type": "string"
									}
								}
							}
						},
						"locationTypes": {
							"type": "array"
						},
						"regulatedActivities": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"name": {
										"type": "string"
									},
									"code": {
										"type": "string"
									},
									"contacts": {
										"type": "array"
									}
								}
							}
						},
						"gacServiceTypes": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"name": {
										"type": "string"
									},
									"description": {
										"type": "string"
									}
								}
							}
						},
						"specialisms": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"name": {
										"type": "string"
									}
								}
							}
						},
						"inspectionCategories": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"code": {
										"type": "string"
									},
									"primary": {
										"type": "string"
									},
									"name": {
										"type": "string"
									}
								}
							}
						},
						"inspectionAreas": {
							"type": "array"
						},
						"historicRatings": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"reportDate": {
										"type": "string"
									},
									"reportLinkId": {
										"type": "string"
									},
									"overall": {
										"type": "object",
										"properties": {
											"rating": {
												"type": "string"
											},
											"keyQuestionRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"name": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														}
													}
												}
											}
										}
									}
								}
							}
						},
						"reports": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"linkId": {
										"type": "string"
									},
									"reportDate": {
										"type": "string"
									},
									"firstVisitDate": {
										"type": "string"
									},
									"reportUri": {
										"type": "string"
									},
									"reportType": {
										"type": "string"
									}
								}
							}
						},
						"assessmentServiceGroup": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"assessmentServiceId": {
										"type": "string"
									},
									"assessmentServiceName": {
										"type": "string"
									},
									"status": {
										"type": "string"
									}
								}
							}
						},
						"assessment": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"assessmentPlanPublishedDateTime": {
										"type": "string"
									},
									"ratings": {
										"type": "object",
										"properties": {
											"asgRatings": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"assessmentPlanId": {
															"type": "string"
														},
														"title": {
															"type": "string"
														},
														"assessmentDate": {
															"type": "string"
														},
														"assessmentPlanStatus": {
															"type": "string"
														},
														"name": {
															"type": "string"
														},
														"rating": {
															"type": "string"
														},
														"status": {
															"type": "string"
														},
														"commentary": {
															"type": "string"
														},
														"commentaryDate": {
															"type": "string"
														},
														"narrative": {
															"type": "string"
														},
														"overallPeopleExperience": {
															"type": "string"
														},
														"overallPeopleExperienceDate": {
															"type": "string"
														},
														"keyQuestionRatings": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"name": {
																		"type": "string"
																	},
																	"rating": {
																		"type": "string"
																	},
																	"status": {
																		"type": "string"
																	},
																	"commentary": {
																		"type": "string"
																	},
																	"commentaryDate": {
																		"type": "string"
																	},
																	"narrative": {
																		"type": "string"
																	},
																	"percentageScore": {
																		"type": "string"
																	},
																	"topicareas": {
																		"type": "array",
																		"items": {
																			"type": "object",
																			"properties": {
																				"name": {
																					"type": "string"
																				},
																				"qualityStatementId": {
																					"type": "string"
																				},
																				"status": {
																					"type": "string"
																				},
																				"evidenceCategory": {
																					"type": "array",
																					"items": {
																						"type": "object",
																						"properties": {
																							"evidenceCategoryId": {
																								"type": "string"
																							},
																							"commentary": {
																								"type": "string"
																							},
																							"commentaryDate": {
																								"type": "string"
																							}
																						}
																					}
																				},
																				"qualityStatementscore": {
																					"type": "string"
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CQC_locationresponses_file_Binary')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileType": {
						"type": "string"
					}
				},
				"folder": {
					"name": "CQC"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@concat('locationresponses', '/', formatDateTime(utcNow(), 'yyyy'),'/',formatDateTime(utcNow(), 'MM'),'/',formatDateTime(utcNow(), 'dd'), '/', dataset().FileType)",
							"type": "Expression"
						},
						"container": "cqc"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CQC_providerresponses_file_Binary')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileType": {
						"type": "string"
					}
				},
				"folder": {
					"name": "CQC"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@concat('providerresponses', '/', formatDateTime(utcNow(), 'yyyy'),'/',formatDateTime(utcNow(), 'MM'),'/',formatDateTime(utcNow(), 'dd'), '/', dataset().FileType)",
							"type": "Expression"
						},
						"container": "cqc"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CareBlox_Container')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Careblox"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "careblox"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CareBlox_Container_SubFolder')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FolderName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Careblox"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@dataset().FolderName",
							"type": "Expression"
						},
						"container": "careblox"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CareBlox_FTP_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CareBlox_FTP",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Careblox/FTP"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "FtpServerLocation"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Hydra_RadarFile')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "XMl file for Radar system. Combined values from fusion and Radar into a single file for Radar.",
				"linkedServiceName": {
					"referenceName": "Hydra_FTP",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Radar"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "FtpServerLocation",
						"fileName": "radar-output.xml"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_MCM_Communities')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MCM API",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"APIKey": {
						"type": "string"
					},
					"Query": {
						"type": "string"
					}
				},
				"folder": {
					"name": "MCM"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().APIKey, '/', dataset().Query)",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_MCM_Get_Generic')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Dataset used to Get data from MCM API. Query (endpoint/report) is required as is a communityID",
				"linkedServiceName": {
					"referenceName": "MCM API",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"APIKey": {
						"type": "string"
					},
					"Query": {
						"type": "string"
					},
					"CommunityID": {
						"type": "string"
					}
				},
				"folder": {
					"name": "MCM"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().APIKey, '/', dataset().Query, '?communityID=', dataset().CommunityID)\n\n",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_MCM_Json')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "MCM"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@concat(dataset().FileName, '.json')",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@concat( formatDateTime(utcNow(), 'yyyy'),'/',formatDateTime(utcNow(), 'MM'),'/',formatDateTime(utcNow(), 'dd'))",
							"type": "Expression"
						},
						"container": "mcm"
					}
				},
				"schema": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_PolestaStorageAcc_Fileshare_Json')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageFileshare",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "FileShare"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureFileStorageLocation"
					}
				},
				"schema": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_PolestarStorageAcc_AEMS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "PolestarStorageAcc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Folder": {
						"type": "string"
					},
					"FileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "AEMS"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().Folder",
							"type": "Expression"
						},
						"container": "aems"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": []
		}
	]
}