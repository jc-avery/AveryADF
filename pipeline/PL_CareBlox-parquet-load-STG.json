{
	"name": "PL_CareBlox-parquet-load-STG",
	"properties": {
		"description": "Load data from the parquet files to the stage (STG) tables in SQL TRANSFORM DB",
		"activities": [
			{
				"name": "STGtblEmpJobs",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Set DateString",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"additionalColumns": [
							{
								"name": "SourceFileName",
								"value": "$$FILEPATH"
							}
						],
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "JobAutoID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "JobAutoID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ContractedHours",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "ContractedHours",
									"type": "Single",
									"physicalType": "real"
								}
							},
							{
								"source": {
									"name": "Department",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "Department",
									"type": "Int16",
									"physicalType": "smallint"
								}
							},
							{
								"source": {
									"name": "Role",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "Role",
									"type": "Int16",
									"physicalType": "smallint"
								}
							},
							{
								"source": {
									"name": "JobNo",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "JobNo",
									"type": "Byte",
									"physicalType": "tinyint"
								}
							},
							{
								"source": {
									"name": "StartDate",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "StartDate",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Holidays",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "Holidays",
									"type": "Double",
									"physicalType": "float"
								}
							},
							{
								"source": {
									"name": "HolidayFull",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "HolidayFull",
									"type": "Double",
									"physicalType": "float"
								}
							},
							{
								"source": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "BreakRule",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "BreakRule",
									"type": "Byte",
									"physicalType": "tinyint"
								}
							},
							{
								"source": {
									"name": "ContractID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ContractID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Deleted",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "Deleted",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "LastUpdate",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "LastUpdate",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "WorkingArrangements",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "WorkingArrangements",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "VHEnabled",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "VHEnabled",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "VHBalance",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "VHBalance",
									"type": "Single",
									"physicalType": "real"
								}
							},
							{
								"source": {
									"name": "VHBalanceDate",
									"type": "Int32",
									"physicalType": "INT32"
								},
								"sink": {
									"name": "VHBalanceDate",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "SicknessThreshold",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "SicknessThreshold",
									"type": "Single",
									"physicalType": "real"
								}
							},
							{
								"source": {
									"name": "SourceFileName",
									"type": "String"
								},
								"sink": {
									"name": "SourceFileName",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblEmpJobs$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB_CareBlox_stg",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "stgtblEmpJobs"
						}
					}
				]
			},
			{
				"name": "STGtblEmployees",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "STGtblEmpJobs",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"additionalColumns": [
							{
								"name": "SourceFileName",
								"value": "$$FILEPATH"
							}
						],
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "EmployeeAutoID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "EmployeeAutoID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Title",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Title",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Forename",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Forename",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Middlename",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Middlename",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Surname",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Surname",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "LocationID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LocationID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "AddressLine1",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AddressLine1",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "AddressLine2",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AddressLine2",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "AddressLine3",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AddressLine3",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "AddressLine4",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AddressLine4",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "AddressLine5",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AddressLine5",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "PostCode",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "PostCode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Country",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Country",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Telephone",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Telephone",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Mobile",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Mobile",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Email",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Email",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "BirthDate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "BirthDate",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "CountryOfBirth",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "CountryOfBirth",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "YearOfEntry",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "YearOfEntry",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "DateStarted",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "DateStarted",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "LeavingDate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "LeavingDate",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "LeavingEnteredBy",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LeavingEnteredBy",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "LeavingEnteredOn",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "LeavingEnteredOn",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Gender",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Gender",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "NINumber",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "NINumber",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "EthnicOrigin",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EthnicOrigin",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Religion",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Religion",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Disability",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Disability",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Nationality",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Nationality",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Dependants",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "Dependants",
									"type": "Byte",
									"physicalType": "tinyint"
								}
							},
							{
								"source": {
									"name": "AccountNumber",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AccountNumber",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "AccountName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AccountName",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "SortCode",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "SortCode",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "BankName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "BankName",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "BankBranch",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "BankBranch",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "BuildingSocRef",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "BuildingSocRef",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "MaritalStatus",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "MaritalStatus",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "PayMethod",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "PayMethod",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "UploadAsNewStarter",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "UploadAsNewStarter",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "NeedsUploading",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "NeedsUploading",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "HasLeft",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "HasLeft",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "PackageID",
									"type": "Int32",
									"physicalType": "INT32"
								},
								"sink": {
									"name": "PackageID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ImportPackageID",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "ImportPackageID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ContractedHours",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "ContractedHours",
									"type": "Single",
									"physicalType": "real"
								}
							},
							{
								"source": {
									"name": "DefaultPayRate",
									"type": "Int32",
									"physicalType": "INT32"
								},
								"sink": {
									"name": "DefaultPayRate",
									"type": "Single",
									"physicalType": "real"
								}
							},
							{
								"source": {
									"name": "LeavingReason",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LeavingReason",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "LeavingDestination",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LeavingDestination",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "IncludeInNextPay",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "IncludeInNextPay",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "OnSick",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "OnSick",
									"type": "String",
									"physicalType": "char"
								}
							},
							{
								"source": {
									"name": "Export",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "Export",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "SageID",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "SageID",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "TATagID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "TATagID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "BankStaff",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "BankStaff",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "PostCodeSearch",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "PostCodeSearch",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "WorkingTimeWaiver",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "WorkingTimeWaiver",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "BatchID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "BatchID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmployeeType",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "EmployeeType",
									"type": "Int16",
									"physicalType": "smallint"
								}
							},
							{
								"source": {
									"name": "HolidayMonthStart",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "HolidayMonthStart",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "CreatedByID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "CreatedByID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "CreatedByName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "CreatedByName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "CreatedDate",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "CreatedDate",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ShortDisplayName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ShortDisplayName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "DisplayColour",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "DisplayColour",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ApproverName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ApproverName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ApproverID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ApproverID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "IsApprover",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "IsApprover",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "TAApprover",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "TAApprover",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "RosterUnitList",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "RosterUnitList",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "PrimaryRosterUnit",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "PrimaryRosterUnit",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "PortalEnabled",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "PortalEnabled",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "PortalPassword",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "PortalPassword",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NoticePeriod",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "NoticePeriod",
									"type": "Byte",
									"physicalType": "tinyint"
								}
							},
							{
								"source": {
									"name": "DataUpgradedDate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "DataUpgradedDate",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "DataUpgradedBy",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "DataUpgradedBy",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "SourceFileName",
									"type": "String"
								},
								"sink": {
									"name": "SourceFileName",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblEmployees$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB_CareBlox_stg",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "STGtblEmployees"
						}
					}
				]
			},
			{
				"name": "STGtblPayrollData",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "STGtblEmployees",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"additionalColumns": [
							{
								"name": "SourceFileName",
								"value": "$$FILEPATH"
							}
						],
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "PayrollID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "PayrollID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EmployeeName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeName",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "LocationID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LocationID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "RoleID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "RoleID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Role",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Role",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "TypeID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "TypeID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Type",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Type",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Rate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "Rate",
									"type": "Decimal",
									"physicalType": "money",
									"scale": 4,
									"precision": 19
								}
							},
							{
								"source": {
									"name": "Units",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "Units",
									"type": "Double",
									"physicalType": "float"
								}
							},
							{
								"source": {
									"name": "Comment",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Comment",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "EnteredDate",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "EnteredDate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "EnteredBy",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EnteredBy",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "EnteredByName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EnteredByName",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "PeriodNo",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "PeriodNo",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "HasVariance",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "HasVariance",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "MonthSplit",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "MonthSplit",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Comitted",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "Comitted",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ApprovedDate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "ApprovedDate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ApprovedBy",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ApprovedBy",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "ApprovedByName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ApprovedByName",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "ImportedFromTA",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "ImportedFromTA",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "WorkedLocationID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "WorkedLocationID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "BatchID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "BatchID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ItemDate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "ItemDate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "SourceFileName",
									"type": "String"
								},
								"sink": {
									"name": "SourceFileName",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblPayrollData$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB_CareBlox_stg",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "STGtblPayrollData"
						}
					}
				]
			},
			{
				"name": "STGtblPeriods",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "STGtblPayrollData",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"additionalColumns": [
							{
								"name": "SourceFileName",
								"value": "$$FILEPATH"
							}
						],
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "PeriodID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "PeriodID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "CurrentPeriodNum",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "CurrentPeriodNum",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "DateCreated",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "DateCreated",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "LocationID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LocationID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "DateRange",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "DateRange",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "GeneratedPayroll",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "GeneratedPayroll",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "SourceFileName",
									"type": "String"
								},
								"sink": {
									"name": "SourceFileName",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblPeriods$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB_CareBlox_stg",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "STGtblPeriods"
						}
					}
				]
			},
			{
				"name": "STGtblRates",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "STGtblPeriods",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"additionalColumns": [
							{
								"name": "SourceFileName",
								"value": "$$FILEPATH"
							}
						],
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "RatesAutoID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "RatesAutoID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "RoleID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "RoleID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "TypeID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "TypeID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Rate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "Rate",
									"type": "Decimal",
									"physicalType": "smallmoney",
									"scale": 4,
									"precision": 10
								}
							},
							{
								"source": {
									"name": "IsDefault",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "IsDefault",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "Deleted",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "Deleted",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "LastUpdate",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "LastUpdate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "SourceFileName",
									"type": "String"
								},
								"sink": {
									"name": "SourceFileName",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblRates$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB_CareBlox_stg",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "STGtblRates"
						}
					}
				]
			},
			{
				"name": "STGtblShifts",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "STGtblRates",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"additionalColumns": [
							{
								"name": "SourceFileName",
								"value": "$$FILEPATH"
							}
						],
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ShiftID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ShiftID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "HomeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "HomeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "RoleID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "RoleID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ShiftStart",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ShiftStart",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ShiftEnd",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ShiftEnd",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "PayRate",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "PayRate",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Department",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "Department",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Type",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Type",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "Deleted",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "Deleted",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "RosterUnitID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "RosterUnitID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "CreatedBy",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "CreatedBy",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "CreatedDate",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "CreatedDate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "DeletedBy",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "DeletedBy",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "DeletedDate",
									"type": "Int32",
									"physicalType": "INT32"
								},
								"sink": {
									"name": "DeletedDate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ITG_SourceID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ITG_SourceID",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ITG_SourceName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ITG_SourceName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ITG_Status",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ITG_Status",
									"type": "Byte",
									"physicalType": "tinyint"
								}
							},
							{
								"source": {
									"name": "RosterType",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "RosterType",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "SourceFileName",
									"type": "String"
								},
								"sink": {
									"name": "SourceFileName",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblShifts$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB_CareBlox_stg",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "STGtblShifts"
						}
					}
				]
			},
			{
				"name": "STGtblTAData",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "STGtblShifts",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"additionalColumns": [
							{
								"name": "SourceFileName",
								"value": "$$FILEPATH"
							}
						],
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "LocalID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "LocalID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "TAID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "TAID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "HomeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "HomeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "RoleID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "RoleID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ShiftID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ShiftID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "TAStatus",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "TAStatus",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "TADateIn",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "TADateIn",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ActualDateIn",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ActualDateIn",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ConfirmedDateIn",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ConfirmedDateIn",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "EarlyInFlag",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "EarlyInFlag",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "EarlyInComment",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EarlyInComment",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "LateInFlag",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "LateInFlag",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "LateInComment",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LateInComment",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "TADateOut",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "TADateOut",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ActualDateOut",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "ActualDateOut",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ConfirmedDateOut",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "ConfirmedDateOut",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "EarlyOutFlag",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "EarlyOutFlag",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "EarlyOutComment",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EarlyOutComment",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "LateOutFlag",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "LateOutFlag",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "LateOutComment",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LateOutComment",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ManagerApprovalRequiredIn",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ManagerApprovalRequiredIn",
									"type": "Byte",
									"physicalType": "tinyint"
								}
							},
							{
								"source": {
									"name": "ManagerApprovalRequiredOut",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ManagerApprovalRequiredOut",
									"type": "Byte",
									"physicalType": "tinyint"
								}
							},
							{
								"source": {
									"name": "RecordedMinutes",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "RecordedMinutes",
									"type": "Int16",
									"physicalType": "smallint"
								}
							},
							{
								"source": {
									"name": "TATagID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "TATagID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "ImageFilename",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ImageFilename",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Imported",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "Imported",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "SrcUnit",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "SrcUnit",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "ExternalWorkerName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ExternalWorkerName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "SourceFileName",
									"type": "String"
								},
								"sink": {
									"name": "SourceFileName",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblTAData$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB_CareBlox_stg",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "STGtblTAData"
						}
					}
				]
			},
			{
				"name": "tblHome",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "STGtblTAData",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "upsert",
						"upsertSettings": {
							"useTempDB": true,
							"keys": [
								"AutoHMID"
							]
						},
						"sqlWriterUseTableLock": false,
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "AutoHMID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "AutoHMID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "HomeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "HomeID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "HomeName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "HomeName",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "HomeEmail",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "HomeEmail",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Address1",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Address1",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Address2",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Address2",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Address3",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Address3",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Address4",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Address4",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "PostCode",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "PostCode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Telephone",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Telephone",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "Fax",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Fax",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "SageCode",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "SageCode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "DepartmentCode",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "DepartmentCode",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Withdrawn",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "Withdrawn",
									"type": "Boolean",
									"physicalType": "bit"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblHome$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB",
						"type": "DatasetReference",
						"parameters": {
							"Schema": "CareBlox",
							"Table": "tblHome"
						}
					}
				]
			},
			{
				"name": "Set DateString",
				"description": "Sets the date string used for Dataset property",
				"type": "SetVariable",
				"dependsOn": [],
				"policy": {
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"variableName": "DateString",
					"value": {
						"value": "@utcNow('dd-MM-yyyy')",
						"type": "Expression"
					}
				}
			},
			{
				"name": "STGtblEmpJobs Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "STGtblEmpJobs",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('STGtblEmpJobs').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "STGtblEmpJobs"
					}
				}
			},
			{
				"name": "STGtblEmployees Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "STGtblEmployees",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('STGtblEmployees').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "STGtblEmployees"
					}
				}
			},
			{
				"name": "STGtblPayrollData Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "STGtblPayrollData",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('STGtblPayrollData').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "STGtblPayrollData"
					}
				}
			},
			{
				"name": "STGtblPeriods Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "STGtblPeriods",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('STGtblPeriods').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "STGtblPeriods"
					}
				}
			},
			{
				"name": "STGtblRates Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "STGtblRates",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('STGtblRates').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "STGtblRates"
					}
				}
			},
			{
				"name": "STGtblShifts Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "STGtblShifts",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('STGtblShifts').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "STGtblShifts"
					}
				}
			},
			{
				"name": "STGtblTAData Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "STGtblTAData",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('STGtblTAData').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "STGtblTAData"
					}
				}
			},
			{
				"name": "tblHome Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "tblHome",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('tblHome').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "tblHome"
					}
				}
			},
			{
				"name": "STGtblCalender",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "tblHome",
						"dependencyConditions": [
							"Completed"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "ParquetSource",
						"additionalColumns": [
							{
								"name": "SourceFileName",
								"value": "$$FILEPATH"
							}
						],
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "ParquetReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "UniqueID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "UniqueID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeID",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "StartDate",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "StartDate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "EmployeeName",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EmployeeName",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "EndDate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "EndDate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "Status",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "Status",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "LocationID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "LocationID",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "StartDetails",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "StartDetails",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EndDetails",
									"type": "Int32",
									"physicalType": "INT32"
								},
								"sink": {
									"name": "EndDetails",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EnteredOn",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "EnteredOn",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "UpdatedOn",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "UpdatedOn",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "EnteredBy",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "EnteredBy",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "UpdatedBy",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "UpdatedBy",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "Export",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "Export",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "ShowAlert",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ShowAlert",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "Department",
									"type": "Int32",
									"physicalType": "INT32"
								},
								"sink": {
									"name": "Department",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "RosterID",
									"type": "Int32",
									"physicalType": "INT32"
								},
								"sink": {
									"name": "RosterID",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "Role",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "Role",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "DaysTaken",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "DaysTaken",
									"type": "Double",
									"physicalType": "float"
								}
							},
							{
								"source": {
									"name": "EnteredByID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "EnteredByID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "BatchId",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "BatchId",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "AbsenceCode",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AbsenceCode",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "AbsenceCategory",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "AbsenceCategory",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "BradfordFactorInclude",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "BradfordFactorInclude",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "Reviewed",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "Reviewed",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "UpdatedByID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "UpdatedByID",
									"type": "Int32",
									"physicalType": "int"
								}
							},
							{
								"source": {
									"name": "UpdateType",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "UpdateType",
									"type": "Byte",
									"physicalType": "tinyint"
								}
							},
							{
								"source": {
									"name": "ExpectedEndDate",
									"type": "Double",
									"physicalType": "DOUBLE"
								},
								"sink": {
									"name": "ExpectedEndDate",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ActivityID",
									"type": "Int64",
									"physicalType": "INT64"
								},
								"sink": {
									"name": "ActivityID",
									"type": "Int64",
									"physicalType": "bigint"
								}
							},
							{
								"source": {
									"name": "ActivityLocationID",
									"type": "String",
									"physicalType": "UTF8"
								},
								"sink": {
									"name": "ActivityLocationID",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "BOOLEAN"
								},
								"sink": {
									"name": "SentToUnit",
									"type": "Boolean",
									"physicalType": "bit"
								}
							},
							{
								"source": {
									"name": "SourceFileName",
									"type": "String"
								},
								"sink": {
									"name": "SourceFileName",
									"type": "String",
									"physicalType": "varchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AZStorage_careblox_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"FileName": "tblCalender$",
							"DateString": {
								"value": "@variables('DateString')",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_AH2_TRANSFORM_DB_CareBlox_stg",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "stgtblCalender"
						}
					}
				]
			},
			{
				"name": "tblCalender Error",
				"type": "ExecutePipeline",
				"dependsOn": [
					{
						"activity": "STGtblCalender",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"pipeline": {
						"referenceName": "UT_Send_Email_Param",
						"type": "PipelineReference"
					},
					"waitOnCompletion": true,
					"parameters": {
						"EmailTo": "jon.crockett@averyhealthcare.co.uk",
						"Message": {
							"value": "@activity('STGtblCalender').output.errors[0].Message",
							"type": "Expression"
						},
						"Colour": "Red",
						"PipelineName": {
							"value": "@pipeline().Pipeline",
							"type": "Expression"
						},
						"PipelineRunID": {
							"value": "@pipeline().RunId",
							"type": "Expression"
						},
						"pStepFailed": "STGtblCalender"
					}
				}
			}
		],
		"variables": {
			"DateString": {
				"type": "String"
			},
			"vStepFailed": {
				"type": "String"
			}
		},
		"folder": {
			"name": "Careblox/Children Pipelines"
		},
		"annotations": [],
		"lastPublishTime": "2024-10-01T11:08:39Z"
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}